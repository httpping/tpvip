<!doctype html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>移动组的日志系统</title>

    <style>

        body{
            margin: 20px;
        }


    </style>
</head>
<body>
<h1>移动研发日志系统</h1>
<!--
<input type="text"  id="platform_name" class="form-control" placeholder="平台过滤:" aria-label="平台过滤:" />
<button onclick="clearLog()" type="button" class="btn btn-dark">清除历史日志(默认所有)</button>
-->

<div class="input-group mb-3" style="width:95%">
    <input  th:value="${domain}" id="platform_name" type="text" class="form-control" placeholder="过滤平台" aria-label="Recipient's username" aria-describedby="basic-addon2">
    &nbsp;&nbsp;&nbsp;
    <div class="input-group-append">
        <button  onclick="search()" class="btn btn-outline-secondary" type="button" >搜索历史日志</button>
        &nbsp;&nbsp;&nbsp;
        <button  onclick="clearLog()" class="btn btn-outline-secondary" type="button" >清除历史日志</button>
    </div>
</div>

<table class="table table-hover">
    <thead class="thead-dark">
    <tr>
        <th scope="col">#</th>
        <th scope="col">Url</th>
        <th scope="col">Platform</th>
        <th scope="col">FeeTime(ms)</th>
        <th scope="col">UpdateTime</th>
        <th scope="col">Option</th>
    </tr>
    </thead>
    <tbody>

    <tr th:each="log ,logStat: ${logs}" onclick="goNext(${log.id})">
        <th scope="row" th:text="${logStat.index + 1}"></th>
        <td th:text="${log.url}"></td>
        <td th:text="${log.domain}"></td>
        <td th:text="${log.feeTime}"></td>
        <td th:text="${#dates.format(log.updateTime, 'yyyy-MM-dd hh:mm:ss')}"></td>
        <td ><a th:href="${ '/api/delete/' + log.id}" class="btn btn-light" >删除</a> &nbsp;&nbsp;&nbsp; <a th:href="${ '/api/show/' + log.id}"  class="btn btn-info">查看</a>
            &nbsp;&nbsp;&nbsp;   <a th:href="${ '/api/edit/' + log.id}"  class="btn btn-info">模拟</a>
        </td>
    </tr>

    </tbody>
</table>




<script type="text/javascript">


    function goNext(id) {
        //to
        window.location.href = '/api/'+id;
    }

    function clearLog() {


        var domain = $('#platform_name').val();
        // window.location.href = '/api/deleteAll';

        // jQuery.post("/api/deleteAll",{domain:domain},function(result){
        //     window.location.href = "/api"
        // });


        $.ajax({
            type: "POST",
            url: "/api/deleteAll",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({domain:domain}),
            dataType: "json",
            success: function (message) {
                window.reload()
                if (message > 0) {
                    alert("请求已提交！我们会尽快与您取得联系");
                }
            },
            error: function (message) {
                $("#request-process-patent").html("提交数据失败！");
            }
        });
    }

    function search() {
        var domain = $('#platform_name').val();
        window.location.href ='/api?domain='+domain;
    }

</script>
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js" ></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="150" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>


</body>
</html>

