<!doctype html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>移动组的日志系统</title>


</head>
<body>
<header>
    <div class="collapse bg-dark" id="navbarHeader">
        <div class="container">
            <div class="row">
                <div class="col-sm-8 col-md-7 py-4">
                    <h4 class="text-white">沁园春·雪</h4>
                    <p class="text-muted">
                        北国风光，千里冰封，万里雪飘。
                        望长城内外，惟余莽莽；大河上下，顿失滔滔。
                        山舞银蛇，原驰蜡象，欲与天公试比高。
                        须晴日，看红装素裹，分外妖娆。
                        江山如此多娇，引无数英雄竞折腰。
                        惜秦皇汉武，略输文采；唐宗宋祖，稍逊风骚。
                        一代天骄，成吉思汗，只识弯弓射大雕。
                        俱往矣，数风流人物，还看今朝。</p>
                </div>
                <div class="col-sm-4 offset-md-1 py-4">
                    <h4 class="text-white">Contact</h4>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Mobile R&D team</a></li>
                        <li><a href="https://github.com/" class="text-white">Follow on Github</a></li>
                        <li><a href="#" class="text-white">Email me</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <div class="navbar navbar-dark bg-dark box-shadow">
        <a href="#" class="navbar-brand">
            <!--<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>-->
            <strong>移动研发日志系统</strong>
        </a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarHeader" aria-controls="navbarHeader" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</header>


<!--
<input type="text"  id="platform_name" class="form-control" placeholder="平台过滤:" aria-label="平台过滤:" />
<button onclick="clearLog()" type="button" class="btn btn-dark">清除历史日志(默认所有)</button>
-->
<div style="margin: 20px">
<div class="input-group mb-3" style="width:95%">
    <input  th:value="${domain}" id="platform_name" type="text" class="form-control" placeholder="过滤平台" aria-label="Recipient's username" aria-describedby="basic-addon2">
    &nbsp;&nbsp;&nbsp;
    <div class="input-group-append">
        <button  onclick="search()" class="btn btn-outline-secondary" type="button" >搜索历史日志</button>
        &nbsp;&nbsp;&nbsp;
        <button  onclick="clearLog()" class="btn btn-outline-secondary" type="button" >清除历史日志</button>
    </div>
</div>

<table class="table table-hover">
    <thead class="thead-dark">
    <tr>
        <th scope="col">#</th>
        <th scope="col">Url</th>
        <th scope="col">Platform</th>
        <th scope="col">FeeTime(ms)</th>
        <th scope="col">UpdateTime</th>
        <th scope="col">Option</th>
    </tr>
    </thead>
    <tbody>

    <tr th:each="log ,logStat: ${logs}" onclick="goNext(${log.id})">
        <th scope="row" th:text="${logStat.index + 1}"></th>
        <td th:text="${log.url}"></td>
        <td th:text="${log.domain}"></td>
        <td th:text="${log.feeTime}"></td>
        <td th:text="${#dates.format(log.updateTime, 'yyyy-MM-dd hh:mm:ss')}"></td>
        <td ><a th:href="${ '/api/delete/' + log.id}" class="btn btn-light btn-sm" >删除</a> &nbsp;&nbsp;<a th:href="${ '/api/show/' + log.id}"  class="btn btn-info btn-sm">查看</a>
            &nbsp;&nbsp;  <a th:href="${ '/api/model/' + log.id}"  class="btn btn-info btn-sm" data-toggle="tooltip" data-placement="top" title="快速模拟会帮你根据现在的接口内容生成模拟接口数据   ">一键建模</a>
            &nbsp;&nbsp; <button type="button" th:onclick="'ticket(\'' + ${log.id.toString()} + '\',' + ${log.ticket} + ')'" th:class="${log.ticket == 1} ? 'btn btn-warning btn-secondary btn-sm':'btn btn-success btn-sm'" th:text="${log.ticket == 1 ?'已锁定':'未锁定'}" data-toggle="tooltip" data-placement="top" title="锁定状态，不会更新接口数据内容"></button>

        </td>
    </tr>

    </tbody>
</table>

</div>


<script type="text/javascript">


    function goNext(id) {
        //to
        window.location.href = '/api/'+id;
    }

    function ticket(id,ticket) {

        if (ticket == 0){
            ticket = 1
        }else{
            ticket = 0
        }

        $.ajax({
            type: "POST",
            url: "/api/ticket",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({id:id,ticket:ticket}),
            dataType: "json",
            success: function (message) {
                window.location.reload()

            },
            error: function (message) {
            }
        });
    }

    function clearLog() {

        var domain = $('#platform_name').val();

        $.ajax({
            type: "POST",
            url: "/api/deleteAll",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({domain:domain}),
            dataType: "json",
            success: function (message) {
                window.location.reload()

            },
            error: function (message) {
            }
        });
    }

    function search() {
        var domain = $('#platform_name').val();
        window.location.href ='/api?domain='+domain;
    }

</script>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js" ></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="150" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>

<script>
    $(function () { $("[data-toggle='tooltip']").tooltip(); });
</script>
</body>
</html>

