<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head  >
    <meta charset="utf-8"/>
    <title>WebSocket Logger</title>
    <script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.js"></script>
    <script src="https://cdn.bootcss.com/sockjs-client/1.1.4/sockjs.min.js"></script>
    <script src="https://cdn.bootcss.com/stomp.js/2.3.3/stomp.min.js"></script>
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://rawgithub.com/yesmeck/jquery-jsonview/master/dist/jquery.jsonview.css" />
    <script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
    <script type="text/javascript" src="https://rawgithub.com/yesmeck/jquery-jsonview/master/dist/jquery.jsonview.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <style>
        .jsonview {
            font-family: monospace;
            font-size: 1.1em;
            white-space: pre-wrap; }
        .jsonview .prop {
            font-weight: bold;
            text-decoration: none;
            color: #A8B6C5; }
        .jsonview .null {
            color: #A8B6C5; }
        .jsonview .undefined {
            color: #A8B6C5; }
        .jsonview .bool {
            color: #A8B6C5; }
        .jsonview .num {
            color: #A8B6C5; }
        .jsonview .string {
            color: #A8B6C5;
            white-space: pre-wrap; }
        .jsonview .string.multiline {
            display: inline-block;
            vertical-align: text-top; }
        .jsonview .collapser {
            position: absolute;
            left: -1em;
            cursor: pointer; }
        .jsonview .collapsible {
            transition: height 1.2s;
            transition: width 1.2s; }
        .jsonview .collapsible.collapsed {
            height: .8em;
            width: 1em;
            display: inline-block;
            overflow: hidden;
            margin: 0; }
        .jsonview .collapsible.collapsed:before {
            content: "…";
            width: 1em;
            margin-left: .2em; }
        .jsonview .collapser.collapsed {
            transform: rotate(0deg); }
        .jsonview .q {
            display: inline-block;
            width: 0px;
            color: transparent; }
        .jsonview li {
            position: relative; }
        .jsonview ul {
            list-style: none;
            margin: 0 0 0 2em;
            padding: 0; }
        .jsonview h1 {
            font-size: 1.2em; }
        a{
            color:#AE8ABE;
        }
    </style>
</head>
<body style="width: 100%">
<header th:include="/common::header"></header>

<hr/>
&nbsp;&nbsp; <button type="button" th:onclick="'ticket(\'' + ${log.id.toString()} + '\',' + ${log.ticket} + ')'" th:class="${log.ticket == 1} ? 'btn btn-warning btn-secondary btn-sm':'btn btn-success btn-sm'" th:text="${log.ticket == 1 ?'已锁定':'未锁定'}" data-toggle="tooltip" data-placement="top" title="锁定状态，不会更新接口数据内容"></button>
<br/>
<div id="log-container" style="height: 830px; overflow-y: scroll; background: #333; color: #aaa; padding: 10px;">
    <div id="content">

        <span class="color:red">请求地址:</span> <br/>  <span th:text="${log.url}"></span>
        <hr/>
        <span class="color:red">请求参数:</span> <br/>
        <div id="request" ></div>
        <hr/>
        <span class="color:red"> 返回结果:</span><br/>
        <div id="response" ></div>
    </div>


</div>
<script th:inline="javascript">
    var message = [[${log.response}]];
    //console.log(message);
    try {
        $('#response').JSONView(message);
    }catch(err)  {
        $('#response').append(message);
    }

    try {
        $('#request').JSONView([[${log.request}]])
    }catch (err){
        $('#request').append([[${log.request}]])
    }


    function ticket(id,ticket) {

        if (ticket == 0){
            ticket = 1
        }else{
            ticket = 0
        }

        $.ajax({
            type: "POST",
            url: "/api/ticket",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({id:id,ticket:ticket}),
            dataType: "json",
            success: function (message) {
                window.location.reload()

            },
            error: function (message) {
            }
        });
    }

</script>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.js"></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

<script type="text/javascript" color="0,0,255" opacity='0.7' zIndex="-2" count="150"
        src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>

</body>
</html>